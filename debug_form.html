<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Depuración del Formulario de Contacto</title>
    <link rel="stylesheet" href="frontend/assets/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            padding: 20px;
            background-color: #f9f9f9;
        }
        .debug-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #5a8f69;
            margin-bottom: 30px;
        }
        .log {
            background-color: #000;
            color: #00ff00;
            padding: 15px;
            border-radius: 5px;
            height: 300px;
            overflow-y: auto;
            margin: 20px 0;
            font-family: monospace;
            font-size: 14px;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        .btn {
            padding: 10px 20px;
            background-color: #5a8f69;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 10px;
        }
        .btn:hover {
            background-color: #4a7a5a;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>Prueba de Depuración del Formulario de Contacto</h1>
        
        <div class="controls">
            <button class="btn" onclick="clearLog()">Limpiar Registro</button>
            <button class="btn" onclick="testFormLoad()">Probar Carga del Formulario</button>
        </div>
        
        <div id="log" class="log"></div>
        
        <div id="formContainer">
            <!-- El formulario se cargará aquí -->
        </div>
    </div>

    <script>
        // Función para registrar mensajes
        function log(message) {
            const logElement = document.getElementById('log');
            const timestamp = new Date().toISOString();
            logElement.innerHTML += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        // Función para limpiar el registro
        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }
        
        // Función para probar la carga del formulario
        function testFormLoad() {
            log('Iniciando prueba de carga del formulario...');
            
            // Simular la carga del componente de contacto
            const contactFormHTML = `
                <section id="contact" class="contact">
                    <h2 class="section-title">Formulario de Prueba</h2>
                    <div class="contact-form">
                        <form id="contactForm">
                            <div class="form-group">
                                <input type="text" id="name" name="name" placeholder="Tu Nombre" required>
                            </div>
                            <div class="form-group">
                                <input type="email" id="email" name="email" placeholder="Tu Email" required>
                            </div>
                            <div class="form-group">
                                <input type="tel" id="phone" name="phone" placeholder="Tu Teléfono">
                            </div>
                            <div class="form-group">
                                <textarea id="message" name="message" placeholder="Tu Mensaje" rows="5" required></textarea>
                            </div>
                            <div id="formMessage" class="form-message"></div>
                            <button type="submit" class="btn btn-primary">Enviar Mensaje</button>
                        </form>
                    </div>
                </section>
            `;
            
            // Insertar el formulario en el contenedor
            document.getElementById('formContainer').innerHTML = contactFormHTML;
            log('Formulario insertado en el DOM');
            
            // Simular la inicialización de los event listeners
            setTimeout(() => {
                initializeTestForm();
            }, 100);
        }
        
        // Función para mostrar mensajes en el formulario de contacto
        function showFormMessage(type, message) {
            const messageElement = document.getElementById('formMessage');
            if (messageElement) {
                messageElement.textContent = message;
                messageElement.className = `form-message ${type}`;
                
                // Ocultar el mensaje después de 5 segundos
                setTimeout(() => {
                    messageElement.className = 'form-message';
                }, 5000);
            }
        }
        
        // Función para manejar el envío del formulario de contacto (versión de prueba)
        async function handleContactFormSubmit(event) {
            log('Función handleContactFormSubmit llamada (versión de prueba)');
            event.preventDefault();
            log('Evento preventDefault ejecutado');
            
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const message = document.getElementById('message').value;
            
            log('Datos del formulario: ' + JSON.stringify({ name, email, phone, message }));
            
            // Mostrar mensaje de carga
            const submitButton = document.querySelector('#contactForm .btn');
            const originalText = submitButton.textContent;
            submitButton.textContent = 'Enviando...';
            submitButton.disabled = true;
            
            try {
                // Simular envío al backend
                log('Simulando envío al backend...');
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Simular una respuesta exitosa
                const result = {
                    message: 'Mensaje enviado exitosamente. Nos pondremos en contacto contigo pronto.'
                };
                
                log('Respuesta simulada del backend: ' + JSON.stringify(result));
                showFormMessage('success', result.message);
                // Limpiar el formulario
                document.getElementById('contactForm').reset();
                log('Formulario limpiado');
                
            } catch (error) {
                log('Error al enviar el formulario: ' + error.message);
                showFormMessage('error', 'Error al enviar el mensaje. Por favor, inténtalo de nuevo más tarde.');
            } finally {
                // Restaurar botón
                submitButton.textContent = originalText;
                submitButton.disabled = false;
                log('Botón restaurado');
            }
        }
        
        // Función para inicializar los event listeners del formulario de prueba
        function initializeTestForm() {
            log('Inicializando event listeners para el formulario de prueba');
            const contactForm = document.getElementById('contactForm');
            if (contactForm) {
                contactForm.addEventListener('submit', handleContactFormSubmit);
                log('Event listener adjuntado correctamente al formulario de prueba');
            } else {
                log('ERROR: No se pudo encontrar el formulario de prueba');
            }
        }
        
        // Inicializar cuando el DOM esté cargado
        document.addEventListener('DOMContentLoaded', function() {
            log('DOM completamente cargado');
        });
        
        // Registrar inicio de la página
        log('Página de depuración cargada');
    </script>
</body>
</html>